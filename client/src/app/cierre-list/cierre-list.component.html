<div class="page">
  <div class="header">
    <div>
      <h2>Historial de cierres</h2>
      <p class="sub">Control diario de stock · solo admin</p>
    </div>
  </div>

  <div *ngIf="cargando" class="loading">Cargando cierres...</div>

  <div class="tabla" *ngIf="!cargando && cierres.length > 0">
    <div class="fila header-row">
      <div>Fecha</div>
      <div>Productos</div>
      <div>Diferencias</div>
      <div>Total sistema</div>
      <div>Total contado</div>
      <div>Diferencia</div>
      <div></div>
    </div>

    <div class="fila" *ngFor="let c of cierres">
      <div class="fecha">{{ c.fecha }}</div>

      <div>
        <b>{{ c.totalProductos }}</b>
      </div>

      <div>
        <span
          class="badge"
          [class.ok]="c.conDiferencias === 0"
          [class.bad]="c.conDiferencias > 0"
        >
          {{ c.conDiferencias === 0 ? "OK" : c.conDiferencias + " dif." }}
        </span>
      </div>
      <div class="money">
        <b>$ {{ c.totalVentasTeorico }}</b>
      </div>

      <div class="money">
        <b>$ {{ c.totalCajaContada }}</b>
      </div>

      <div class="money">
        <span
          class="badge"
          [class.ok]="c.diferenciaCaja === 0"
          [class.bad]="c.diferenciaCaja !== 0"
        >
          {{ c.diferenciaCaja === 0 ? "OK" : "$ " + c.diferenciaCaja }}
        </span>
      </div>
      <div class="actions">
        <a class="btn-ghost" [routerLink]="['/app/cierres', c._id]">
          Ver detalle
        </a>
      </div>
    </div>
  </div>

  <div class="empty" *ngIf="!cargando && cierres.length === 0">
    Todavía no hay cierres guardados.
  </div>
</div>
